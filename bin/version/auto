#!/usr/bin/env bash

set -e
echo "> version:auto"

git checkout npm 2>/dev/null || git checkout --orphan npm
npm version patch -m "%s"

# git checkout head~2 -- test # todo: check if theres a previous commit

# if [ -d test/module ] && {

#   npm run verify:major && {
#     npm version major -m "%s"
#     npm reset --hard test
#     exit 0
#   }

#   npm run verify:minor && {
#     npm version minor -m "%s"
#     npm reset --hard test
#     exit 0
#   }
#     # if this fails


#   npm run test -- $(find test -type f -name *.js -not -path test/module/\*)
# }







# ### running continuous integration build on node.js matrix
# git reset --hard origin/master
# npm run test

# ## in order to determine version bump entity
# git checkout head~2 -- test

#  # run module api tests
# if [ -d test/module ] && {

#   npm run test -- $(find test/module -type f -name \*.js)
#     # if this fails
#       npm version major -m "%s"
#       exit 0

#   npm run test -- $(find test -type f -name *.js -not -path test/module/\*)

# }
